function stage.increase(player) {
	$stage++;
	quest.display(player, $quest_name, $stage, $all_stages);
	sound = sound.get("ENTITY_EXPERIENCE_ORB_PICKUP");
	category = sound.getCategory("MASTER");
	sound.spawnForPlayer(player, sound, category);
}

function quest.start(player, path) {
	modTimer(-45);
	script = script.start(path, "utils/u_quest", "utils/u_general", "utils/u_questerror");
	if(script == null) {
		snuvi.debug("quest not started");
		return;
	}
	quest.addPlayer(script, player);
	script.setVar(script, "player", player);
	script.setVar(script, "script", script);
	script.callEvent("quest_start", script);
	inv.close(player);
}

function player.unlockedLumberjack(player_or_id) {
	config = playerdata.getSurvival(player_or_id);
	return config.getBool(config, "skillshop.lumberjack", false);
}

function player.unlockLumberjack(player_or_id) {
	config = playerdata.getSurvival(player_or_id);
	config.set(config, "skillshop.lumberjack", true);
	config.saveAsync(config);
}

function player.unlockedMage(player_or_id) {
	config = playerdata.getSurvival(player_or_id);
	return config.getBool(config, "skillshop.mage", false);
}

function player.unlockMage(player_or_id) {
	config = playerdata.getSurvival(player_or_id);
	config.set(config, "skillshop.mage", true);
	config.saveAsync(config);
}

function player.getShipProgress(player_or_id) {
	config = playerdata.getSurvival(player_or_id);
	return config.getDouble(config, "ship.progress", 0);
}

function player.setShipProgress(player_or_id, progress) {
	config = playerdata.getSurvival(player_or_id);
	old_progress = config.getDouble(config, "ship.progress", 0);
	if(progress > old_progress) {
		config.set(config, "ship.progress", progress);
		config.saveAsync(config);
	}
}

function human.giveItem(human_name, player, needed_type_or_tag, needed_amount) {
	if(needed_amount == 0) {
		return -1;
	}
	item = living.getHand(player);
	if(item == null) {
		return needed_amount;
	}
	item_type = item.getType(item);
	human_name = string.concat("Â§d", human_name);
	needed = false;
	tag_check = false;
	if(isMaterial(needed_type_or_tag)) {
		if(item_type == needed_type_or_tag) {
			needed = true;
		}
	} else {
		if(item.hasTag(item, needed_type_or_tag)) {
			needed = true;
			tag_check = true;
		}
	}
	if(needed) {
		rest_item = player.removeItem(player, item.new(item_type, needed_amount));
		if(rest_item == 0) {
			return 0;
		}
		amount_not_removed = item.getAmount(rest_item);
		player.removeItem(player, item.new(item_type, amount_not_removed));
		rest_item_amount = needed_amount - amount_not_removed;
		
		rest_item = player.removeItemNbt(player, rest_item);
		rest_item_amount = item.getAmount(rest_item);
		if(rest_item_amount > 0) {
			if(tag_check) {
				rest_item = player.removeItemTag(player, needed_type_or_tag, rest_item_amount);
				rest_item_amount = item.getAmount(rest_item);
				if(rest_item_amount > 0) {
					msg.prefix(player, human_name, string.concat("I need ", text.number(rest_item_amount), " more of these please."));
				}
			} else {
				msg.prefix(player, human_name, string.concat("I need ", text.number(rest_item_amount), " more of these please."));
			}
		}
		return rest_item_amount;
	}
	msg.prefix(player, human_name, "I do not need this.");
	return needed_amount;
}